---
title: Supervisor (Colas de Laravel)
description: GestiÃ³n de procesos en segundo plano para CSDOCS.
---

import { Steps, Tabs, TabItem, Card } from '@astrojs/starlight/components';

# ğŸ—ï¸ Supervisor - Control de Procesos

Laravel utiliza colas para tareas pesadas (envÃ­o de correos, generaciÃ³n de PDFs, etc.). Supervisor asegura que estos trabajadores de colas nunca se detengan.

---

## ğŸ“¦ InstalaciÃ³n

```bash
sudo apt update
sudo apt install supervisor -y
```

---

## âš™ï¸ ConfiguraciÃ³n de un Worker

Crea el archivo `/etc/supervisor/conf.d/csdocs-worker.conf`:

```ini
[program:csdocs-worker]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/csdocs/artisan queue:work --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/var/www/csdocs/storage/logs/worker.log
stopwaitsecs=3600
```

---

## ğŸ•¹ï¸ Comandos Ãštiles

<Steps>

1.  **Releer configuraciones nuevas**
    ```bash
    sudo supervisorctl reread
    ```

2.  **Activar cambios**
    ```bash
    sudo supervisorctl update
    ```

3.  **Ver estado**
    ```bash
    sudo supervisorctl status
    ```

4.  **Reiniciar todo**
    ```bash
    sudo supervisorctl restart all
    ```

</Steps>

<Card title="Importante" icon="warning">
  Cada vez que realices un despliegue de cÃ³digo (git pull), recuerda reiniciar supervisor para que los trabajadores usen la nueva versiÃ³n del cÃ³digo.
</Card>
